# app029: 投資クイズ - 要件定義書

## 1. アプリ概要
投資初心者向けの基礎知識テストアプリ。株式、債券、投資信託、リスク管理等の基本的な知識をクイズ形式で楽しく学習できる。

## 2. 目的・課題

### 解決する課題
- 投資初心者が何から学べばいいか分からない
- 投資の専門用語が難しく、学習のハードルが高い
- 座学だけでは知識が定着しにくい
- 自分の理解度を確認する方法がない
- 投資を始める前の不安が大きい

### 目的
- 投資の基礎知識を楽しく学習
- クイズ形式で理解度を確認
- 正解・不正解の解説で理解を深める
- 投資への心理的ハードルを下げる

## 3. ターゲットユーザー
- 投資初心者（これから投資を始めたい人）
- 投資の基礎を復習したい人
- 金融リテラシーを高めたい学生
- 投資教育を行う教員・講師

## 4. 機能要件

### 4.1 必須機能（MVP）
- **クイズ出題**
  - 4択問題形式
  - 1セット10問
  - カテゴリー別出題（株式/債券/投資信託/リスク管理/税金等）
  - ランダム出題

- **回答・採点**
  - 選択肢をクリックで回答
  - 即座に正誤判定
  - 正解の表示
  - 解説文の表示

- **スコア表示**
  - 正解数/総問題数
  - 正答率（パーセント）
  - カテゴリー別正答率

- **問題バンク**
  - 最低50問のプリセット問題
  - カテゴリー分類（5〜7カテゴリー）
  - 難易度設定（初級/中級/上級）

### 4.2 拡張機能（優先度：中）
- **学習モード**
  - 間違えた問題の復習
  - カテゴリー別学習
  - 弱点克服モード（正答率の低いカテゴリー優先）

- **進捗管理**
  - 学習履歴の記録
  - 累計正答率の表示
  - 学習日数のカウント
  - 達成バッジ機能

- **問題追加機能**
  - ユーザーが問題を追加（将来的な拡張）
  - 問題のインポート/エクスポート

- **タイマー機能**
  - 1問あたりの制限時間設定
  - タイムアタックモード

### 4.3 将来的な拡張（優先度：低）
- マルチプレイヤー対戦モード
- ランキング機能
- 実際のニュースを基にした時事問題

### 4.4 AI機能（Gemini API）
- **問題自動生成**
  - Gemini APIが投資知識に基づいて新しいクイズ問題を自動生成
  - カテゴリー・難易度を指定して生成
  - 4択問題形式で自動作成
  - 生成された問題をレビュー・編集可能

- **解説の強化・拡充**
  - 既存問題の解説をより詳しく・分かりやすく改善
  - 初心者向けの補足説明を自動追加
  - 実例・具体例を含めた解説生成

- **弱点診断・学習アドバイス**
  - 間違えた問題を分析
  - 理解が不足しているトピックを特定
  - 重点的に学習すべきカテゴリーを提案
  - 学習ロードマップの提示

- **類似問題の自動生成**
  - 間違えた問題に類似した練習問題を生成
  - 同じ概念を異なる角度から問う問題を作成
  - 理解度を確認する復習問題の提供

- **最新トレンドの反映**
  - 投資・金融の最新トレンドに基づく問題生成
  - 新しい制度・ルールを反映した問題

## 5. 非機能要件

### 5.1 パフォーマンス
- 問題表示の遅延 < 100ms
- スムーズな画面遷移
- 100問以上でも軽快に動作

### 5.2 ユーザビリティ
- 直感的な操作（クリックのみ）
- 視認性の高いUI
- レスポンシブデザイン（スマホ対応）

### 5.3 データ管理
- LocalStorageで進捗データを保存
- 問題データはJSON形式

## 6. 技術制約

### 6.1 環境要件
- モダンブラウザ対応
- レスポンシブデザイン（スマホ・タブレット・デスクトップ）
- オフライン動作可能

### 6.2 データ制約
- 問題データはクライアントサイドで管理
- LocalStorageで進捗保存

### 6.3 教育的配慮
- 投資勧誘と誤解されない表現
- 初心者にも分かりやすい解説
- 正確な金融知識の提供

### 6.4 AI API仕様
- **使用API**: Google Gemini API
  - モデル: gemini-2.0-flash-exp
  - エンドポイント: Google AI Studio API

- **APIキー管理**
  - 保存場所: LocalStorage
  - 保存形式: 平文（暗号化なし）
  - キー名: `gemini_api_key`
  - 設定UI: アプリ内設定画面で登録・変更可能

- **起動時チェック**
  - APIキー未登録時は設定画面を表示
  - APIキー検証（簡易的な接続テスト）
  - エラーハンドリング（APIキー無効時の対応）

- **AI機能の利用**
  - AI機能はオプション（APIキーなしでも基本機能は利用可能）
  - API呼び出しエラー時の適切なフィードバック
  - レート制限への対応
  - 生成された問題の品質チェック（ユーザーレビュー必須）

## 7. 成功基準

### 7.1 機能面
- ✅ クイズがスムーズに出題・回答できる
- ✅ 正誤判定と解説が適切に表示される
- ✅ スコアが正確に計算・表示される
- ✅ カテゴリー別学習ができる

### 7.2 UX面
- ✅ 初心者でも楽しく学習できる
- ✅ 解説が分かりやすい
- ✅ 達成感を感じられる

### 7.3 教育面
- ✅ 投資の基礎知識を正確に学べる
- ✅ 理解度を客観的に確認できる
- ✅ 学習意欲が継続する

## 8. 制約事項・前提条件

### 8.1 制約事項
- 投資助言・勧誘は行わない（教育目的のみ）
- 実際の銘柄名・商品名は使用しない
- リアルマネーの取引機能は含まない

### 8.2 前提条件
- ユーザーは日本語が理解できる
- 基本的な金融用語の理解がある（または学習意欲がある）

## 9. UI/UX要求

### 9.1 デザイン方向性
- 親しみやすく、堅苦しくないデザイン
- 正解時は緑、不正解時は赤で視覚的フィードバック
- 学習アプリとしての楽しさを演出

### 9.2 主要画面
1. **ホーム画面**
   - アプリ名・キャッチコピー
   - クイズ開始ボタン（カテゴリー選択/ランダム）
   - 学習進捗サマリー
   - 累計正答率・学習日数

2. **カテゴリー選択画面**
   - カテゴリー一覧（株式/債券/投資信託等）
   - 各カテゴリーの問題数・正答率表示
   - 難易度選択（初級/中級/上級）

3. **クイズ画面**
   - 上部: 問題番号（1/10）、カテゴリー名
   - 中央: 問題文
   - 選択肢（4つ）
   - 下部: 次へボタン（回答後に表示）

4. **解説画面**
   - 正誤表示（⭕/❌）
   - 正解の選択肢をハイライト
   - 詳しい解説文
   - 次の問題ボタン

5. **結果画面**
   - スコア表示（10問中8問正解！）
   - 正答率（80%）
   - カテゴリー別正答率
   - 間違えた問題の復習ボタン
   - ホームに戻るボタン

## 10. スケジュール・優先度

### Phase 1（MVP）
- クイズ出題・回答・採点機能
- 50問のプリセット問題作成
- スコア表示
- カテゴリー別出題

### Phase 2（拡張）
- 学習モード（復習機能）
- 進捗管理
- 達成バッジ

### Phase 3（改善）
- タイマー機能
- 問題追加機能
- UI/UXブラッシュアップ

## 11. 問題カテゴリー（初期案）

1. **株式投資の基本**（10問）
   - 株式とは何か、株価の決まり方、配当金、株主優待等

2. **債券投資の基本**（8問）
   - 債券とは何か、利回り、格付け等

3. **投資信託・ETF**（10問）
   - 投資信託の仕組み、ETFとの違い、信託報酬等

4. **リスク管理**（10問）
   - リスクとリターン、分散投資、ポートフォリオ等

5. **税金・制度**（8問）
   - NISA、iDeCo、確定申告等

6. **経済用語**（8問）
   - GDP、インフレ、金利、為替等

## 12. データ構造（初期案）

```json
{
  "questions": [
    {
      "id": "q001",
      "category": "株式投資の基本",
      "difficulty": "初級",
      "question": "株式を購入することで得られる主な利益は次のうちどれでしょうか？",
      "choices": [
        "配当金と値上がり益",
        "利息",
        "家賃収入",
        "給与"
      ],
      "correctAnswer": 0,
      "explanation": "株式を保有することで、企業から配当金を受け取ることができます。また、株価が上昇した時に売却すれば値上がり益（キャピタルゲイン）を得られます。"
    }
  ],
  "userProgress": {
    "totalQuizzes": 5,
    "totalCorrect": 38,
    "totalQuestions": 50,
    "categoryStats": {
      "株式投資の基本": {"correct": 8, "total": 10},
      "リスク管理": {"correct": 6, "total": 10}
    },
    "studyDays": 3,
    "lastStudyDate": "2025-01-01"
  }
}
```

## 13. 問題例

### 問題1（初級・株式投資の基本）
**Q:** 株式投資で得られる利益には主に2種類あります。それは何でしょうか？

**選択肢:**
1. 配当金と値上がり益 ✅
2. 利息と家賃
3. 給与と賞与
4. 為替差益と利息

**解説:** 株式投資の利益は、企業が利益の一部を株主に還元する「配当金（インカムゲイン）」と、株価が上昇した時に売却して得られる「値上がり益（キャピタルゲイン）」の2つが主なものです。

### 問題2（中級・リスク管理）
**Q:** 投資におけるリスク分散の考え方として正しいものはどれでしょうか？

**選択肢:**
1. すべての資金を最も有望な1銘柄に投資する
2. 複数の異なる資産に分散して投資する ✅
3. 投資は危険なのでやらない
4. 常に現金で保有する

**解説:** 「卵を1つのカゴに盛るな」という格言があるように、複数の異なる資産（株式、債券、不動産等）に分散投資することで、特定の資産が値下がりしても全体の損失を抑えることができます。
